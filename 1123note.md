# Ruby on Rails - 2023/11/23

## 驗證

- 前端驗證都在演戲
- 可以看[Rails guide](https://guides.rubyonrails.org/active_record_validations.html)
-

## namespace

```ruby
aaa::bbb

module aaa
    class bbb
    end
end
```

## 省略

- hash 是最後一個參數，大括號可以適當省略掉

```ruby
validates（ :title, {presence: ture}）
# 可簡寫成
validates :title, presence: ture
```

## moudle 內的 Product

```ruby
class Product < ApplicationRecord
  validates :title, presence: true
  validates :price, numericality: { greater_than: 0 }
  #validate_presence_of: Rails 3以前寫法
end
```

試看看

```terminal
$ rails c --sandbox

Loading development environment in sandbox (Rails 7.1.2)
Any modifications you make will be rolled back on exit

$ p1 = Product.new

TRANSACTION (0.0ms)  begin transaction
=> #<Product:0x0000000107740f10 id: nil, title: nil, description: nil, price: nil, created_at: nil, updated_at: nil>

$ p1.errors.any?
=> false

$ p1.save
=> false

$ p1.errors.full_messages

=> ["Title can't be blank", "Price is not a number"]
irb(main):005>

$ p1.title = 'ccc'
=> "ccc"

$ p1.price = '100'
=> "100"

$ p1. save
  TRANSACTION (0.1ms)  SAVEPOINT active_record_1
  Product Create (1.8ms)  INSERT INTO "products" ("title", "description", "price", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"  [["title", "ccc"], ["description", nil], ["price", 100.0], ["created_at", "2023-11-23 03:05:02.158018"], ["updated_at", "2023-11-23 03:05:02.158018"]]
  TRANSACTION (0.0ms)  RELEASE SAVEPOINT active_record_1
=> true
```

## form helper

```ruby
#new.html.erb
<%= form_with modle: @product,
              url: root_path,
              method: 'post',
              data: {turbo: false} do %>
123
<% end %>

#product_controller.rb
  def new
    @product = Product.new
  end
```

## Rails 設計兩大哲學

DRY = Don't Repeat Yourself COC

Coc = Convention over Configuration

## 遇到錯誤

錯誤會用以下包住

```css
fiels_with_errors
```

## Nesting

```css
nav {
  ul {
  }
}
```

## Partial View

在 rails 裏面，partial view 命名規則\_name.html.erb
